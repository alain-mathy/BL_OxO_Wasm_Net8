@using BL_OxO_Wasm_Net8.Shared.Models

@if(CurrentRoom is not null)
{
	<h3>@CurrentRoom.RoomName</h3>

	@if(CurrentRoom.Players.Count < 2)
	{
		<h4>Waiting for player to join...</h4>
	}
}

@code {
	[CascadingParameter]
	public HubConnection? HubConnection { get; set; }

	[Parameter]
	public GameRoom? CurrentRoom { get; set; }

	private string? myPlayerId;

	protected override async Task OnInitializedAsync()
	{
		if (CurrentRoom is null || HubConnection is null || HubConnection.ConnectionId is null)
		{
			return;
		}

		myPlayerId = HubConnection.ConnectionId;

		HubConnection.On<Player>("PlayerJoined", player =>
		{
			CurrentRoom.Players.Add(player);
			StateHasChanged();
		});
	}
}
